<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeepSeek API æµ‹è¯•</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #74b9ff, #a29bfe);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        h1 {
            text-align: center;
            color: #2d3436;
            font-size: 2rem;
            margin-bottom: 30px;
        }
        .test-button {
            background: linear-gradient(135deg, #00cec9, #74b9ff);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            display: block;
            margin: 20px auto;
            transition: all 0.3s ease;
        }
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,206,201,0.3);
        }
        .test-button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .result {
            margin-top: 20px;
            padding: 20px;
            border-radius: 10px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        .info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }
        .loading {
            text-align: center;
            color: #666;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¤– DeepSeek API è¿é€šæ€§æµ‹è¯•</h1>
        
        <button id="testBtn" class="test-button">å¼€å§‹æµ‹è¯• API</button>
        
        <div id="result"></div>
    </div>

    <script>
        // API é…ç½®
        const API_KEY = 'sk-17b6bdf87ec54bca94e26f53ba9fdbb0';
        const API_ENDPOINT = 'https://api.deepseek.com/v1/chat/completions';
        const MODEL = 'deepseek-chat';

        const testBtn = document.getElementById('testBtn');
        const resultDiv = document.getElementById('result');

        function showResult(message, type = 'info') {
            resultDiv.className = `result ${type}`;
            resultDiv.textContent = message;
        }

        function showLoading() {
            resultDiv.className = 'result loading';
            resultDiv.textContent = 'ğŸ”„ æ­£åœ¨æµ‹è¯•APIè¿æ¥ï¼Œè¯·ç¨ç­‰...';
        }

        async function testAPI() {
            testBtn.disabled = true;
            showLoading();

            try {
                console.log('ğŸ” å¼€å§‹APIæµ‹è¯•...');
                
                // æ£€æŸ¥åŸºç¡€é…ç½®
                showResult(`ğŸ“‹ APIé…ç½®æ£€æŸ¥ï¼š
ç«¯ç‚¹: ${API_ENDPOINT}
æ¨¡å‹: ${MODEL}
API Key: ${API_KEY.substring(0, 20)}...

ğŸš€ å‘é€æµ‹è¯•è¯·æ±‚...`, 'info');

                const requestBody = {
                    model: MODEL,
                    messages: [
                        {
                            role: "system",
                            content: "ä½ æ˜¯ä¸€ä¸ªå‹å¥½çš„AIåŠ©æ‰‹ã€‚"
                        },
                        {
                            role: "user",
                            content: "è¯·ç®€å•å›å¤ï¼šä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªAPIè¿é€šæ€§æµ‹è¯•ã€‚"
                        }
                    ],
                    temperature: 0.7,
                    max_tokens: 100
                };

                console.log('ğŸ“¤ å‘é€è¯·æ±‚:', requestBody);

                const response = await fetch(API_ENDPOINT, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${API_KEY}`
                    },
                    body: JSON.stringify(requestBody)
                });

                console.log('ğŸ“¥ å“åº”çŠ¶æ€:', response.status, response.statusText);

                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    throw new Error(`APIè¯·æ±‚å¤±è´¥: ${response.status} ${response.statusText}\nè¯¦æƒ…: ${JSON.stringify(errorData, null, 2)}`);
                }

                const data = await response.json();
                console.log('ğŸ“‹ å®Œæ•´å“åº”:', data);

                if (data.choices && data.choices.length > 0 && data.choices[0].message) {
                    const aiContent = data.choices[0].message.content;
                    
                    showResult(`âœ… APIæµ‹è¯•æˆåŠŸï¼

å“åº”çŠ¶æ€: ${response.status} OK
æ¨¡å‹: ${data.model || MODEL}
AIå›å¤: "${aiContent}"

ğŸ“Š ä½¿ç”¨æƒ…å†µ:
- æç¤ºè¯Token: ${data.usage?.prompt_tokens || 'N/A'}
- ç”ŸæˆToken: ${data.usage?.completion_tokens || 'N/A'}
- æ€»Token: ${data.usage?.total_tokens || 'N/A'}

ğŸ‰ DeepSeek APIå·¥ä½œæ­£å¸¸ï¼æ‚¨çš„çµæ„Ÿç²¾çµçƒå¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ã€‚`, 'success');

                } else {
                    throw new Error('APIå“åº”æ ¼å¼å¼‚å¸¸: ' + JSON.stringify(data, null, 2));
                }

            } catch (error) {
                console.error('âŒ APIæµ‹è¯•å¤±è´¥:', error);
                
                let errorMessage = `âŒ APIæµ‹è¯•å¤±è´¥ï¼

é”™è¯¯ä¿¡æ¯: ${error.message}

ğŸ”§ å¯èƒ½çš„è§£å†³æ–¹æ¡ˆ:
`;

                if (error.message.includes('401')) {
                    errorMessage += `
1. âœ“ API Keyæ— æ•ˆæˆ–å·²è¿‡æœŸ
   - è¯·æ£€æŸ¥æ‚¨çš„DeepSeek API Keyæ˜¯å¦æ­£ç¡®
   - ç™»å½•DeepSeekå®˜ç½‘æ£€æŸ¥KeyçŠ¶æ€
   
2. âœ“ æ£€æŸ¥API Keyæ ¼å¼
   - ç¡®ä¿ä»¥ 'sk-' å¼€å¤´
   - æ²¡æœ‰å¤šä½™çš„ç©ºæ ¼æˆ–å­—ç¬¦`;
                } else if (error.message.includes('429')) {
                    errorMessage += `
1. âœ“ APIè°ƒç”¨é¢‘ç‡è¶…é™
   - è¯·ç¨ç­‰å‡ åˆ†é’Ÿåé‡è¯•
   - æ£€æŸ¥æ‚¨çš„APIä½¿ç”¨é…é¢
   
2. âœ“ å‡çº§APIå¥—é¤
   - å¦‚éœ€æ›´é«˜é¢‘ç‡è°ƒç”¨`;
                } else if (error.message.includes('500')) {
                    errorMessage += `
1. âœ“ DeepSeekæœåŠ¡å™¨é”™è¯¯
   - è¿™æ˜¯ä¸´æ—¶çš„æœåŠ¡å™¨é—®é¢˜
   - è¯·ç¨åé‡è¯•
   
2. âœ“ æ£€æŸ¥DeepSeekæœåŠ¡çŠ¶æ€
   - è®¿é—®DeepSeekå®˜ç½‘ç¡®è®¤æœåŠ¡çŠ¶æ€`;
                } else if (error.message.includes('fetch')) {
                    errorMessage += `
1. âœ“ ç½‘ç»œè¿æ¥é—®é¢˜
   - æ£€æŸ¥æ‚¨çš„ç½‘ç»œè¿æ¥
   - ç¡®è®¤èƒ½è®¿é—®å¤–ç½‘
   
2. âœ“ é˜²ç«å¢™/ä»£ç†è®¾ç½®
   - æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦é˜»æ­¢äº†è¯·æ±‚
   - å¦‚ä½¿ç”¨ä»£ç†ï¼Œç¡®è®¤ä»£ç†è®¾ç½®æ­£ç¡®`;
                } else {
                    errorMessage += `
1. âœ“ æ£€æŸ¥ç½‘ç»œè¿æ¥
2. âœ“ éªŒè¯API Keyæœ‰æ•ˆæ€§  
3. âœ“ ç¡®è®¤APIç«¯ç‚¹åœ°å€æ­£ç¡®
4. âœ“ ç¨åé‡è¯•`;
                }

                showResult(errorMessage, 'error');
            } finally {
                testBtn.disabled = false;
            }
        }

        testBtn.addEventListener('click', testAPI);

        // é¡µé¢åŠ è½½å®Œæˆåæ˜¾ç¤ºåˆå§‹ä¿¡æ¯
        window.addEventListener('DOMContentLoaded', () => {
            showResult(`ğŸ¤– DeepSeek API æµ‹è¯•å·¥å…·

å½“å‰é…ç½®:
- APIç«¯ç‚¹: ${API_ENDPOINT}
- æ¨¡å‹: ${MODEL}  
- API Key: ${API_KEY.substring(0, 20)}...

ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æµ‹è¯• API è¿é€šæ€§ã€‚`, 'info');
        });
    </script>
</body>
</html> 